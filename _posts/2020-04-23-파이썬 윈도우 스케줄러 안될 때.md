--- 
layout: post
title: 파이썬 윈도우 스케줄러 안될 때
categories: Python
 
---

py로 등록을 했는데 안된다. 

실행파일로 만들어서 하면 된다길래 각종 모듈들을 사용해서 해봤으나 다 실패.

겨우 만들어진 exe 파일을 등록해봤더니 원래라면 스크립트가 실행되고 생성되어야 할 파일들이 파일들이 생성이 안된다. 그래서 bat파일로 만들어서 해보기로했다. 

한참 시행착오 거치다가 겨우 되서 설정을 기록한다. 


일반 탭 설정

![다운로드](https://user-images.githubusercontent.com/63631604/96842590-30b1d280-1488-11eb-96ce-d46a9359f78b.png)

동작 설정

![다운로드 (1)](https://user-images.githubusercontent.com/63631604/96842720-59d26300-1488-11eb-82b0-20bff657d2bb.png)

프로그램, 스크립트에는 bat 파일 이름만 적어줘야한다. 

나머지 경로는 시작 위치에 적어야한다. 

 
bat 파일 코드
```
@echo off
start [파이썬 경로] [실행할 파이썬 코드 경로] #ex start C:\Users\[myname]\anaconda3\envs\[myenv]\python [py 파일 경로]
#pause 덧붙이면 cmd 창 안꺼짐. 깔끔하게 보이려면 안쓰는 편이 좋다. 
```

 

### 기타 필수 옵션들 

 

일반탭

* 다은 네트워크 연결을 사용할수 있는 경우에만 시작 체크해제 

* 가장높은 수준의 권한으로 실행 체크해제 ->체크시 작업스케줄러 서비스를 사용할 수 없습니다. 에러 가능성 

* 사용자가 로그온 할 때만 실행 체크할 경우 ->NtOpenThread: {액세스 거부} 프로세스가 개체에 액세스를 요구했지만 액세스 권한이 없습니다. (0xc0000022) 에러 가능성 


조건탭 

* 네트워크 연결이 필요한 프로그램의 경우 

* 다음 네크워크 연결을 사용할 수 있는 경우에만 사용 - 모든 연결


기타

* 최대한 기본 설정 안건드려야 오류가 안난다.  

* 파이썬 스크립트의 경우 실행경로에 한글이나 공백이 들어가도 오류가 난다. 

* Project Files 라는 경로에 저장했는데 실행시 에러메시지에 Project 폴더를 찾을 수 없다는 문구가 떴었다. 
